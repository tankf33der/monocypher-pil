(prin "sha512-hmac ")
(test
   (103 156 134 157 160 113 157 198 216 210 96 198 245 56 173 127 91 199 144 245 83 252 133 45 118 43 81 242 100 102 196 154 118 147 143 160 32 27 102 29 17 44 53 156 60 196 168 115 30 182 91 130 53 22 185 74 89 210 58 151 240 9 137 126)
   (crypto_sha512_hmac (range 0 15) (range 0 15)) )
(let Ctx (%@ "malloc" 'P 344)
   (crypto_sha512_hmac_init Ctx (range 0 15))
   (crypto_sha512_hmac_update Ctx (range 0 15))
   (test
      (103 156 134 157 160 113 157 198 216 210 96 198 245 56 173 127 91 199 144 245 83 252 133 45 118 43 81 242 100 102 196 154 118 147 143 160 32 27 102 29 17 44 53 156 60 196 168 115 30 182 91 130 53 22 185 74 89 210 58 151 240 9 137 126)
      (crypto_sha512_hmac_final Ctx) )
   (%@ "free" NIL Ctx) )
(println 'OK)
