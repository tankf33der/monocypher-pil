(prin "sha512 ")
(test
   (207 131 225 53 126 239 184 189 241 84 40 80 214 109 128 7 214 32 228 5 11 87 21 220 131 244 169 33 211 108 233 206 71 208 209 60 93 133 242 176 255 131 24 210 135 126 236 47 99 185 49 189 71 65 122 129 165 56 50 122 249 39 218 62)
   (sha512))
(test
   (138 65 76 88 96 207 27 231 188 133 49 68 47 105 166 94 242 236 240 183 202 217 153 75 203 64 112 151 235 116 204 185 46 147 170 189 36 189 230 3 49 18 59 77 144 6 132 202 123 230 2 112 153 212 148 107 245 55 244 214 198 223 61 130)
   (sha512 (range 0 7)) )
(let Ctx (%@ "malloc" 'P 216)
   (crypto_sha512_init Ctx)
   (crypto_sha512_update Ctx (range 0 7))
   (test
      (138 65 76 88 96 207 27 231 188 133 49 68 47 105 166 94 242 236 240 183 202 217 153 75 203 64 112 151 235 116 204 185 46 147 170 189 36 189 230 3 49 18 59 77 144 6 132 202 123 230 2 112 153 212 148 107 245 55 244 214 198 223 61 130)
      (crypto_sha512_final Ctx) )
.  (%@ "free" NIL Ctx) )
(println 'OK)
